<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>aQuery by Soul-Master</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>aQuery</h1>
        <h2>Window automation-based Query (a fluent jQuery-like API)</h2>
        <a href="https://github.com/Soul-Master/aQuery" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="aquery" class="anchor" href="#aquery" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/Soul-Master/aQuery">aQuery</a>
</h1>

<p>aQuery is a fast, small, and feature-rich C# library that based on <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ff486375(v=vs.85).aspx">Windows Automation API</a>. It makes things like Windows control traversal and manipulation much simpler with an easy-to-use API that works across variety of desktop control like C++ control, windows forms or even WPF. With a combination of versatility and extensibility, aQuery has changed the way that people write automation on Windows application.</p>

<h2>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview</h2>

<p><img src="https://cdn.rawgit.com/Soul-Master/aQuery/master/aQuery/Overview.PNG" alt="Overview image"></p>

<p>Here is the simplest form of aQuery syntax. The following statement use aQuery to select window element with ProcessId equals <code>1234</code></p>

<div class="highlight highlight-source-cs"><pre><span class="pl-c">// Syntax of C# 6.0</span>
<span class="pl-k">using</span> static aQuery.aQuery<span class="pl-k">;</span>

<span class="pl-k">var</span> window = a(<span class="pl-s"><span class="pl-pds">"</span>window[ProcessId=1234]<span class="pl-pds">"</span></span>);</pre></div>

<p>After you can retrieve element from given <code>context</code> (default context is desktop), you can manipulate it via built-in methods like the following statements.</p>

<div class="highlight highlight-source-cs"><pre><span class="pl-c">// Trigger click via InvokePattern</span>
window.Click();</pre></div>

<p>*<a href="https://msdn.microsoft.com/en-us/library/system.windows.automation.invokepattern(v=vs.110).aspx">InvokePattern</a> represents controls that initiate or perform a single, unambiguous action and do not maintain state when activated.</p>

<h2>
<a id="selectors" class="anchor" href="#selectors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Selectors</h2>

<p>As you know, the hardest part of automating application on Windows desktop is selecting control. Normally, application isn't designed to be queried. Control structure doesn't look simple just like normal web page.</p>

<p><img src="https://cdn.rawgit.com/Soul-Master/aQuery/master/demo/Calculator1.png" alt="Calculator App"></p>

<p>Most of control properties that we can retrieve via  <a href="https://msdn.microsoft.com/en-us/library/system.windows.automation.automationelement(v=vs.110).aspx">AutomationElement</a> doesn't unique. We cannot select control by using only one property.</p>

<p><img src="https://cdn.rawgit.com/Soul-Master/aQuery/master/demo/Calculator2.png" alt="Calculator App"> </p>

<p>So I decide to simplify this process by creating aQuery (AutomationElement wrapper) that can query element with jQuery-syntax like command. This is the syntax that currently supports by aQuery.</p>

<pre lang="text"><code>'{Name Property}' {LocalizedControlType}[{PropertyName}={PropertyValue}]:{filterName}({filterValue})
</code></pre>

<p>For selecting title bar of Calculator, you can use one of the following selectors if it doesn't duplicate with other controls.</p>

<ul>
<li>
<code>"'Calculator'"</code> specify only Name property</li>
<li>
<code>"title bar"</code> specify only LocalizedControlType property</li>
<li>
<code>"'Calculator' title bar"</code> specify by Name and LocalizedControlType properties</li>
<li>
<code>[AutomationId=TitleBar][ControlType=ControlType.TitleBar]</code> specify by some properties</li>
<li>
<code>title bar:first</code> specify by <code>LocalizedControlType</code> property and get the first one</li>
</ul>

<p>For more example, please look at source code of <a href="https://github.com/Soul-Master/aQuery/tree/master/aQuery.Amibroker">aQuery.Amibroker</a> project. It contains a lot of useful code for using aQuery.</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/Soul-Master/aQuery/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/Soul-Master/aQuery/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/Soul-Master/aQuery"></a> is maintained by <a href="https://github.com/Soul-Master">Soul-Master</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
